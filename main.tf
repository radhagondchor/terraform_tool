module "networking" {
  source = "./networking"
  cidr_range = var.cidr_range
  instance_tenancy = var.instance_tenancy
  vpc_name = var.vpc_name
  vpc_id = module.networking.vpc_id
  subnet1cidr = var.subnet1cidr
  subnet2cidr = var.subnet2cidr
  subnet3cidr = var.subnet3cidr
  subnet4cidr = var.subnet4cidr
  availability_zone_01 = var.availability_zone_01
  availability_zone_02 = var.availability_zone_02
  subnet_01 = var.subnet_01
  subnet_02 = var.subnet_02
  subnet_03 = var.subnet_03
  subnet_04 = var.subnet_04
  internet_gateway_name = var.internet_gateway_name
  elastic_ip_name = var.elastic_ip_name
  public01_id = module.networking.public01_id
  eip_id = module.networking.eip_id
  name_nat = var.name_nat
  connection_type = var.connection_type
  IG_id = module.networking.IG_id
  NAT_id = module.networking.NAT_id
  rt01_name = var.rt01_name
  rt02_name = var.rt02_name
  nat_cidr_range = var.nat_cidr_range
  public02_id = module.networking.public02_id
  private01_id = module.networking.private01_id
  private02_id = module.networking.private02_id
  RT01_id = module.networking.RT01_id
  RT02_id = module.networking.RT02_id
  public_sg01_name = var.public_sg01_name
  private_sg02_name = var.private_sg02_name
  ssh_port = var.ssh_port
  protocol_tcp = var.protocol_tcp
  protocol_01 = var.protocol_01
  ES_port = var.ES_port
  HTTP_port = var.HTTP_port
  allow_port = var.allow_port
  sg_cidr_range = var.sg_cidr_range
  kibana_port = var.kibana_port
  requester_CIDR = var.requester_CIDR
  accepter_CIDR = var.accepter_CIDR
  region = var.region
  vpc_peering_name = var.vpc_peering_name
}


module "compute" {
  source = "./compute"
  sg01_id = module.networking.sg01_id
  sg02_id = module.networking.sg02_id
  public01_id = module.networking.public01_id
  private01_id = module.networking.private01_id
  private02_id = module.networking.private02_id
  AMI_ID = var.AMI_ID
  instance_type = var.instance_type
  key_name = var.key_name
  instance02_name = var.instance02_name
  instance03_name = var.instance03_name
  instance_name = var.instance_name
  vpc_id = module.networking.vpc_id
  TG_name = var.TG_name
  HTTP_port_tg =  var.HTTP_port_tg
  protocol_type = var.protocol_type
  interval = var.interval
  timeout = var.timeout
  healthy_threshold = var.healthy_threshold
  unhealthy_threshold = var.unhealthy_threshold
  path = var.path
  port_num = var.port_nums[0]
  Target_group_arn = module.compute.Target_group_arn
  private01_vm_id = module.compute.private01_vm_id
  ALB_type = var.ALB_type
  alb_name = var.alb_name
  internal_value = var.internal_value
  public02_id = module.networking.public02_id
  ALB_arn = module.compute.ALB_arn
}
